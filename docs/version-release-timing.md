# 版本发布时机指南

本文档详细说明 L2UI 组件库各个版本类型的发布时机和决策标准。

## 版本发布流程图

```
新功能开发
    ↓
Alpha 版本 (内部测试)
    ↓
Beta 版本 (公开测试)
    ↓
Stable 版本 (生产可用)
    ↓
Patch/Minor/Major 版本 (持续迭代)
```

## 预发布版本时机

### Alpha 版本发布时机

**何时发布 Alpha 版本：**

1. **新功能开发完成**
   - 新组件或新功能已完成开发
   - 代码已通过基本测试
   - 但功能可能不稳定，需要内部验证

2. **重大重构或架构调整**
   - 进行大规模代码重构
   - 调整组件架构或 API 设计
   - 需要内部团队验证兼容性

3. **实验性功能**
   - 尝试新的设计模式或技术方案
   - 需要收集内部反馈
   - API 可能频繁变更

4. **发布频率**
   - 可以频繁发布（每周或每两周）
   - 主要用于内部迭代和验证

**发布示例场景：**

```bash
# 场景 1: 新增 Table 组件，完成基础功能
# 开发完成 → 内部测试 → 发布 alpha
pnpm release:alpha  # 0.1.0 → 0.1.0-alpha.1

# 场景 2: 修复 alpha 版本中的问题
pnpm release:alpha  # 0.1.0-alpha.1 → 0.1.0-alpha.2
```

**Alpha 版本特点：**

- ✅ 功能基本可用
- ⚠️ API 可能频繁变更
- ⚠️ 可能存在已知问题
- ❌ 不建议在生产环境使用

---

### Beta 版本发布时机

**何时发布 Beta 版本：**

1. **Alpha 版本验证通过**
   - Alpha 版本经过内部充分测试
   - 主要问题已修复
   - 功能基本稳定

2. **需要社区反馈**
   - 功能已基本确定
   - API 设计基本稳定（可能有小幅调整）
   - 需要更多用户测试和反馈

3. **准备正式发布前**
   - 作为稳定版本的预演
   - 收集真实使用场景的反馈
   - 发现潜在问题

4. **发布频率**
   - 相对较少（每月 1-2 次）
   - 主要用于收集反馈和验证稳定性

**发布示例场景：**

```bash
# 场景 1: Alpha 版本测试通过，准备公开测试
# 0.1.0-alpha.3 (内部测试通过) → 0.1.0-beta.1
pnpm release:beta

# 场景 2: 根据 Beta 反馈修复问题
pnpm release:beta  # 0.1.0-beta.1 → 0.1.0-beta.2
```

**Beta 版本特点：**

- ✅ 功能稳定
- ✅ API 基本确定
- ⚠️ 可能仍有小问题
- ✅ 可以用于测试环境
- ❌ 不建议用于生产环境（除非特殊情况）

---

### Stable 版本发布时机

**何时发布 Stable 版本：**

1. **Beta 版本验证充分**
   - Beta 版本经过充分测试
   - 收集的反馈已处理
   - 未发现严重问题

2. **功能完整且稳定**
   - 所有计划功能已完成
   - 测试覆盖率达标（≥80%）
   - 文档完整

3. **生产环境就绪**
   - 性能满足要求
   - 无已知严重 Bug
   - 向后兼容性良好

4. **发布频率**
   - 按计划发布（如每季度一次）
   - 或根据功能完成度决定

**发布示例场景：**

```bash
# 场景 1: Beta 版本测试通过，准备正式发布
# 0.1.0-beta.2 (测试通过) → 0.1.0
pnpm release:stable

# 场景 2: 从 Alpha 直接到 Stable（跳过 Beta，适用于小版本）
# 0.1.0-alpha.1 → 0.1.0
pnpm release:stable
```

**Stable 版本特点：**

- ✅ 功能完整且稳定
- ✅ API 稳定，不会频繁变更
- ✅ 经过充分测试
- ✅ 可以用于生产环境
- ✅ 提供长期支持

---

## 正式版本发布时机

### Patch 版本（补丁版本）发布时机

**何时发布 Patch 版本：**

1. **Bug 修复**
   - 修复稳定版本中的 Bug
   - 修复安全问题
   - 修复性能问题

2. **紧急修复**
   - 修复影响生产环境的严重问题
   - 需要快速发布修复

3. **发布频率**
   - 根据需要随时发布
   - 通常每月 1-3 次

**发布示例场景：**

```bash
# 场景 1: 修复 Button 组件的样式问题
# 0.1.0 → 0.1.1
pnpm release:patch

# 场景 2: 修复安全漏洞
# 0.1.1 → 0.1.2
pnpm release:patch
```

**Patch 版本特点：**

- ✅ 只包含修复，不包含新功能
- ✅ 向后兼容
- ✅ 可以安全升级
- ✅ 建议尽快升级

---

### Minor 版本（次版本）发布时机

**何时发布 Minor 版本：**

1. **新增功能**
   - 新增组件
   - 新增 API（不破坏现有功能）
   - 新增功能特性

2. **功能增强**
   - 改进现有组件功能
   - 添加新的配置选项
   - 性能优化

3. **发布频率**
   - 按计划发布（如每 2-3 个月一次）
   - 或根据功能积累决定

**发布示例场景：**

```bash
# 场景 1: 新增 Table 组件
# 0.1.0 → 0.2.0
pnpm release:minor

# 场景 2: 新增 Form 组件的验证功能
# 0.2.0 → 0.3.0
pnpm release:minor
```

**Minor 版本特点：**

- ✅ 包含新功能
- ✅ 向后兼容
- ✅ 可以安全升级
- ✅ 新功能可选使用

---

### Major 版本（主版本）发布时机

**何时发布 Major 版本：**

1. **破坏性变更**
   - 删除或重命名 API
   - 修改 API 的行为（不向后兼容）
   - 移除已废弃的功能

2. **重大架构调整**
   - 重构核心架构
   - 改变设计理念
   - 重大性能优化（可能影响 API）

3. **发布频率**
   - 很少发布（如每年 1-2 次）
   - 需要充分的规划和准备

**发布示例场景：**

```bash
# 场景 1: 重构组件 API，移除旧 API
# 1.0.0 → 2.0.0
pnpm release:major

# 场景 2: 改变设计系统，需要重大调整
# 2.0.0 → 3.0.0
pnpm release:major
```

**Major 版本特点：**

- ⚠️ 可能包含破坏性变更
- ⚠️ 可能需要修改代码才能升级
- ✅ 提供迁移指南
- ✅ 长期支持

---

## 版本发布决策树

```
新功能/修复完成
    ↓
是否包含破坏性变更？
    ├─ 是 → Major 版本 (1.0.0 → 2.0.0)
    └─ 否 ↓
        是否包含新功能？
        ├─ 是 → Minor 版本 (1.0.0 → 1.1.0)
        └─ 否 → Patch 版本 (1.0.0 → 1.0.1)

新功能开发阶段
    ↓
是否经过内部测试？
    ├─ 否 → Alpha 版本 (0.1.0-alpha.1)
    └─ 是 ↓
        是否需要社区反馈？
        ├─ 是 → Beta 版本 (0.1.0-beta.1)
        └─ 否 → Stable 版本 (0.1.0)
```

## 实际发布场景示例

### 场景 1: 新组件开发流程

```
1. 开发 Table 组件
   ↓
2. 完成基础功能，发布 Alpha
   pnpm release:alpha  # 0.2.0 → 0.2.0-alpha.1
   ↓
3. 内部测试，修复问题，发布 Alpha.2
   pnpm release:alpha  # 0.2.0-alpha.1 → 0.2.0-alpha.2
   ↓
4. 测试通过，发布 Beta
   pnpm release:beta   # 0.2.0-alpha.2 → 0.2.0-beta.1
   ↓
5. 收集反馈，修复问题，发布 Beta.2
   pnpm release:beta   # 0.2.0-beta.1 → 0.2.0-beta.2
   ↓
6. 验证通过，发布 Stable
   pnpm release:stable # 0.2.0-beta.2 → 0.2.0
```

### 场景 2: Bug 修复流程

```
1. 发现 Button 组件样式问题
   ↓
2. 修复问题
   ↓
3. 测试通过，发布 Patch
   pnpm release:patch  # 0.2.0 → 0.2.1
```

### 场景 3: 紧急安全修复

```
1. 发现安全漏洞
   ↓
2. 立即修复
   ↓
3. 快速发布 Patch
   pnpm release:patch  # 0.2.1 → 0.2.2
   ↓
4. 通知用户升级
```

### 场景 4: 重大重构

```
1. 计划重构组件 API
   ↓
2. 开发新 API，保持旧 API 兼容
   ↓
3. 发布 Minor 版本，添加新 API
   pnpm release:minor  # 1.0.0 → 1.1.0
   ↓
4. 在文档中标记旧 API 为废弃
   ↓
5. 等待 1-2 个 Minor 版本周期
   ↓
6. 移除旧 API，发布 Major 版本
   pnpm release:major  # 1.2.0 → 2.0.0
```

## 版本发布检查清单

### Alpha 版本发布前

- [ ] 功能基本完成
- [ ] 通过基本测试
- [ ] 代码已提交
- [ ] 内部团队可以测试

### Beta 版本发布前

- [ ] Alpha 版本测试通过
- [ ] 主要问题已修复
- [ ] API 基本确定
- [ ] 文档基本完整
- [ ] 可以公开测试

### Stable 版本发布前

- [ ] Beta 版本测试充分
- [ ] 所有反馈已处理
- [ ] 测试覆盖率 ≥ 80%
- [ ] 文档完整
- [ ] 无已知严重问题
- [ ] 性能满足要求
- [ ] 可以用于生产环境

### Patch 版本发布前

- [ ] Bug 已修复
- [ ] 修复已测试
- [ ] 不影响现有功能
- [ ] 可以快速发布

### Minor 版本发布前

- [ ] 新功能已完成
- [ ] 新功能已测试
- [ ] 向后兼容
- [ ] 文档已更新
- [ ] 可以安全升级

### Major 版本发布前

- [ ] 破坏性变更已确定
- [ ] 迁移指南已准备
- [ ] 充分测试
- [ ] 向后兼容方案已考虑
- [ ] 发布公告已准备

## 版本发布最佳实践

1. **遵循语义化版本规范**
   - 严格按照语义化版本规则发布
   - 不要随意变更版本号

2. **保持发布节奏**
   - Alpha/Beta: 可以频繁发布
   - Stable: 按计划发布
   - Patch: 根据需要发布
   - Minor: 定期发布（如每季度）
   - Major: 谨慎发布

3. **充分测试**
   - 每个版本发布前都要充分测试
   - 确保质量达标

4. **完善文档**
   - 及时更新 CHANGELOG
   - 更新相关文档
   - 提供迁移指南（Major 版本）

5. **及时沟通**
   - 发布前通知团队
   - 发布后通知用户
   - 重要变更提供升级指南

## 相关文档

- [版本发布指南](./release-guide.md) - 详细的发布流程
- [发布检查清单](./release-checklist.md) - 发布前检查项
- [CHANGELOG.md](../CHANGELOG.md) - 变更日志
